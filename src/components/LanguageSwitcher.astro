---
import { languages, getLocalizedPath, getAlternateLanguage, type Lang } from '../i18n';

interface Props {
	lang: Lang;
}

const { lang } = Astro.props;
const currentPath = Astro.url.pathname;
const alternateLang = getAlternateLanguage(lang);
const alternatePath = getLocalizedPath(currentPath.replace(/^\/(en|tr)/, ''), alternateLang);
---

<a
	href={alternatePath}
	class="lang-switch"
	aria-label={`Switch to ${languages[alternateLang]}`}
	data-lang={alternateLang}
>
	{languages[alternateLang]}
</a>

<script>
	document.querySelectorAll('.lang-switch').forEach(link => {
		link.addEventListener('click', () => {
			const lang = link.getAttribute('data-lang');
			// Set cookie for 1 year
			document.cookie = `preferred-lang=${lang}; path=/; max-age=31536000; SameSite=Lax`;
		});
	});
</script>

<style>
	.lang-switch {
		font-family: var(--font-body);
		font-size: 0.8125rem;
		font-weight: 500;
		color: var(--ink-muted);
		text-decoration: none;
		padding: 0.375rem 0.75rem;
		border: 1px solid var(--border);
		transition: all 0.2s ease;
	}

	.lang-switch:hover {
		color: var(--ink);
		border-color: var(--ink);
	}
</style>
